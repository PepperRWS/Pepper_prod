<?xml version="1.0" encoding="UTF-8" ?>
<ChoregrapheProject xmlns="http://www.aldebaran-robotics.com/schema/choregraphe/project.xsd" xar_version="3">
    <Box name="root" id="-1" localization="8" tooltip="Root box of Choregraphe&apos;s behavior. Highest level possible." x="0" y="0">
        <bitmap>media/images/box/root.png</bitmap>
        <script language="4">
            <content>
                <![CDATA[]]>
</content>
        </script>
        <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
        <Input name="onStart" type="1" type_size="1" nature="2" inner="0" tooltip="Box behavior starts when a signal is received on this input." id="2" />
        <Input name="onStop" type="1" type_size="1" nature="3" inner="0" tooltip="Box behavior stops when a signal is received on this input." id="3" />
        <Output name="onStopped" type="1" type_size="1" nature="1" inner="0" tooltip="Signal sent when box behavior is finished." id="4" />
        <Timeline enable="0">
            <BehaviorLayer name="behavior_layer1">
                <BehaviorKeyframe name="keyframe1" index="1">
                    <Diagram>
                        <Box name="waveLeft" id="1" localization="8" tooltip="" x="396" y="9">
                            <bitmap>media/images/box/box-timeLine.png</bitmap>
                            <script language="4">
                                <content>
                                    <![CDATA[]]>
</content>
                            </script>
                            <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
                            <Input name="onStart" type="1" type_size="1" nature="2" inner="0" tooltip="Box behavior starts when a signal is received on this input." id="2" />
                            <Input name="onStop" type="1" type_size="1" nature="3" inner="0" tooltip="Box behavior stops when a signal is received on this input." id="3" />
                            <Output name="onStopped" type="1" type_size="1" nature="1" inner="0" tooltip="Signal sent when box behavior is finished." id="4" />
                            <Timeline enable="1" fps="25" start_frame="1" end_frame="-1" size="120">
                                <ActuatorList model="">
                                    <ActuatorCurve name="value" actuator="HeadPitch" mute="0" unit="0">
                                        <Key frame="12" value="-5.80078" />
                                        <Key frame="20" value="9.14062" />
                                        <Key frame="32" value="9.14062" />
                                        <Key frame="46" value="9.14062" />
                                        <Key frame="61" value="9.14062" />
                                        <Key frame="77" value="5.53711" />
                                        <Key frame="92" value="-1.66993" />
                                        <Key frame="120" value="-11.3379" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="HeadYaw" mute="0" unit="0">
                                        <Key frame="12" value="10.2832" />
                                        <Key frame="20" value="-13.5352" />
                                        <Key frame="32" value="-13.5352" />
                                        <Key frame="46" value="-13.5352" />
                                        <Key frame="61" value="-13.5352" />
                                        <Key frame="77" value="-10.8984" />
                                        <Key frame="92" value="-6.50391" />
                                        <Key frame="120" value="-0.527345" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RElbowRoll" mute="0" unit="0">
                                        <Key frame="12" value="31.0254" />
                                        <Key frame="20" value="63.457" />
                                        <Key frame="32" value="66.3574" />
                                        <Key frame="41" value="29.8144" />
                                        <Key frame="48" value="23.7127" />
                                        <Key frame="55" value="54.2212" />
                                        <Key frame="60" value="60.0141" />
                                        <Key frame="74" value="44.7642" />
                                        <Key frame="85" value="69.6973" />
                                        <Key frame="92" value="69.6973" />
                                        <Key frame="120" value="29.0918" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RElbowYaw" mute="0" unit="0">
                                        <Key frame="12" value="67.1484" />
                                        <Key frame="20" value="67.2363" />
                                        <Key frame="32" value="43.1543" />
                                        <Key frame="39" value="42.79" />
                                        <Key frame="48" value="61.9502" />
                                        <Key frame="60" value="38.8325" />
                                        <Key frame="74" value="59.7935" />
                                        <Key frame="85" value="41.1328" />
                                        <Key frame="92" value="41.1328" />
                                        <Key frame="120" value="70.2246" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RHand" mute="0" unit="1">
                                        <Key frame="12" value="0.589631" />
                                        <Key frame="20" value="0.330404" />
                                        <Key frame="32" value="0.330404" />
                                        <Key frame="46" value="0.330404" />
                                        <Key frame="61" value="0.330404" />
                                        <Key frame="77" value="0.360281" />
                                        <Key frame="92" value="0.450791" />
                                        <Key frame="120" value="0.599297" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RShoulderPitch" mute="0" unit="0">
                                        <Key frame="12" value="89.8242" />
                                        <Key frame="20" value="53.7012" />
                                        <Key frame="46" value="-34.1409" />
                                        <Key frame="61" value="-33.6875" />
                                        <Key frame="77" value="-33.2227" />
                                        <Key frame="92" value="33.8379" />
                                        <Key frame="120" value="89.8242" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RShoulderRoll" mute="0" unit="0">
                                        <Key frame="12" value="-10.1074" />
                                        <Key frame="20" value="-19.7754" />
                                        <Key frame="33" value="-18.4201" />
                                        <Key frame="46" value="-31.8783" />
                                        <Key frame="61" value="-18.6306" />
                                        <Key frame="77" value="-48.252" />
                                        <Key frame="92" value="-21.6004" />
                                        <Key frame="120" value="-8.17382" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="RWristYaw" mute="0" unit="0">
                                        <Key frame="12" value="7.99575" />
                                        <Key frame="20" value="-3.78175" />
                                        <Key frame="32" value="-34.1923" />
                                        <Key frame="46" value="-31.9071" />
                                        <Key frame="61" value="-23.0692" />
                                        <Key frame="77" value="-13.9772" />
                                        <Key frame="92" value="-38.0595" />
                                        <Key frame="120" value="3.0738" />
                                    </ActuatorCurve>
                                </ActuatorList>
                            </Timeline>
                        </Box>
                        <Box name="SelectLeft_Right" id="5" localization="8" tooltip="Generate a random integer between a min number and a max number set as&#x0A;parameters.&#x0A;Note that the min and max numbers are included in the range of possible values." x="234" y="76">
                            <bitmap>media/images/box/box-script.png</bitmap>
                            <script language="4">
                                <content>
                                    <![CDATA[import random

class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self, False)

    def onLoad(self):
        # attributes needed in shuffle mode
        pass

    def onUnload(self):
         #puts code for box cleanup here
        pass

    def onInput_onStart(self):
        side = random.randint( 1, 2 )
        #self.logger.info("Select side " + str(side))
        if ( side == 1):
          self.output_Left()
        else:
          self.output_Right()]]>
</content>
                            </script>
                            <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
                            <Input name="onStart" type="1" type_size="1" nature="1" inner="0" tooltip="Generate a random integer." id="2" />
                            <Output name="output_Left" type="1" type_size="1" nature="2" inner="0" tooltip="The random value obtained." id="3" />
                            <Output name="output_Right" type="1" type_size="1" nature="2" inner="0" tooltip="" id="4" />
                        </Box>
                        <Box name="Set All Anti-Collision" id="2" localization="8" tooltip="Enable or disable the self collision protection on some specific part of the robot&apos;s body.&#x0A;&#x0A;For example if the protection is enabled on his left arm he will move his arm all the&#x0A;same than when it is not but avoiding his other body parts." x="66" y="37">
                            <bitmap>media/images/box/sensors/anti_collision.png</bitmap>
                            <script language="4">
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self, False)

    def onLoad(self):
        self.logger.info("loading winken")
        self.motion = ALProxy( "ALMotion" )

    def onUnload(self):
        pass

    def onInput_onSet(self):
        # is it enable or disable asked?
        enable = (self.getParameter("Action") == "Enable")
        # enable/disable collision protection
        #self.logger.info("Self-Anti enable " + str(enable) + "  " + str(self.getParameter("Body part")))
        result = self.motion.setCollisionProtectionEnabled( self.getParameter("Body part"), enable )
        if( result ):
            self.motion.setExternalCollisionProtectionEnabled( self.getParameter("Body part"), enable )
            self.success()
        else:
            self.logger.warning( "Disabling collision protection failed. Deactivation succeeds only if the current state of the chain is not in collision. If you want to deactivate collision of both arms, they need to be off collision." )
            self.failure()]]>
</content>
                            </script>
                            <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
                            <Input name="onSet" type="1" type_size="1" nature="1" inner="0" tooltip="The anti-collision feature is enabled or disabled when this input is stimulated." id="2" />
                            <Output name="success" type="1" type_size="1" nature="2" inner="0" tooltip="Signal sent if the collision protection has been successfully enabled or disabled.&#x0A;&#x0A;Note: The only case where there is a failure is when you try to disable the&#x0A;anti-collision while it is currently in collision with some part of his body." id="3" />
                            <Output name="failure" type="1" type_size="1" nature="2" inner="0" tooltip="Signal sent if the collision protection has failed to be enabled or disabled.&#x0A;&#x0A;Note: The only case where there is a failure is when you try to disable the&#x0A;anti-collision while it is currently in collision with some part of his body." id="4" />
                            <Parameter name="Body part" inherits_from_parent="0" content_type="3" value="Arms" default_value="Arms" custom_choice="0" tooltip="Body part which avoids the collision." id="5">
                                <Choice value="Arms" />
                                <Choice value="LArm" />
                                <Choice value="RArm" />
                            </Parameter>
                            <Parameter name="Action" inherits_from_parent="1" content_type="3" value="Disable" default_value="Disable" custom_choice="0" tooltip="Enable or disable the collision protection." id="6">
                                <Choice value="Enable" />
                                <Choice value="Disable" />
                            </Parameter>
                        </Box>
                        <Box name="Set All Anti-Collision (1)" id="4" localization="8" tooltip="Enable or disable the self collision protection on some specific part of the robot&apos;s body.&#x0A;&#x0A;For example if the protection is enabled on his left arm he will move his arm all the&#x0A;same than when it is not but avoiding his other body parts." x="549" y="29">
                            <bitmap>media/images/box/sensors/anti_collision.png</bitmap>
                            <script language="4">
                                <content>
                                    <![CDATA[class MyClass(GeneratedClass):
    def __init__(self):
        GeneratedClass.__init__(self, False)

    def onLoad(self):
        self.motion = ALProxy( "ALMotion" )

    def onUnload(self):
        pass

    def onInput_onSet(self):
        # is it enable or disable asked?
        enable = (self.getParameter("Action") == "Enable")
        # enable/disable collision protection
        #self.logger.info("Self-Anti enable " + str(enable) + "  " + str(self.getParameter("Body part")))
        result = self.motion.setCollisionProtectionEnabled( self.getParameter("Body part"), enable )
        if( result ):
            self.motion.setExternalCollisionProtectionEnabled( self.getParameter("Body part"), enable )
            self.success()
        else:
            self.logger.warning( "Disabling collision protection failed. Deactivation succeeds only if the current state of the chain is not in collision. If you want to deactivate collision of both arms, they need to be off collision." )
            self.failure()]]>
</content>
                            </script>
                            <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
                            <Input name="onSet" type="1" type_size="1" nature="1" inner="0" tooltip="The anti-collision feature is enabled or disabled when this input is stimulated." id="2" />
                            <Output name="success" type="1" type_size="1" nature="2" inner="0" tooltip="Signal sent if the collision protection has been successfully enabled or disabled.&#x0A;&#x0A;Note: The only case where there is a failure is when you try to disable the&#x0A;anti-collision while it is currently in collision with some part of his body." id="3" />
                            <Output name="failure" type="1" type_size="1" nature="2" inner="0" tooltip="Signal sent if the collision protection has failed to be enabled or disabled.&#x0A;&#x0A;Note: The only case where there is a failure is when you try to disable the&#x0A;anti-collision while it is currently in collision with some part of his body." id="4" />
                            <Parameter name="Body part" inherits_from_parent="0" content_type="3" value="Arms" default_value="Arms" custom_choice="0" tooltip="Body part which avoids the collision." id="5">
                                <Choice value="Arms" />
                                <Choice value="LArm" />
                                <Choice value="RArm" />
                            </Parameter>
                            <Parameter name="Action" inherits_from_parent="1" content_type="3" value="Enable" default_value="Disable" custom_choice="0" tooltip="Enable or disable the collision protection." id="6">
                                <Choice value="Enable" />
                                <Choice value="Disable" />
                            </Parameter>
                        </Box>
                        <Box name="waveLeft (1)" id="3" localization="8" tooltip="" x="398" y="131">
                            <bitmap>media/images/box/box-timeLine.png</bitmap>
                            <script language="4">
                                <content>
                                    <![CDATA[]]>
</content>
                            </script>
                            <Input name="onLoad" type="1" type_size="1" nature="0" inner="1" tooltip="Signal sent when diagram is loaded." id="1" />
                            <Input name="onStart" type="1" type_size="1" nature="2" inner="0" tooltip="Box behavior starts when a signal is received on this input." id="2" />
                            <Input name="onStop" type="1" type_size="1" nature="3" inner="0" tooltip="Box behavior stops when a signal is received on this input." id="3" />
                            <Output name="onStopped" type="1" type_size="1" nature="1" inner="0" tooltip="Signal sent when box behavior is finished." id="4" />
                            <Timeline enable="1" fps="25" start_frame="1" end_frame="-1" size="127">
                                <ActuatorList model="">
                                    <ActuatorCurve name="value" actuator="LElbowRoll" mute="0" unit="0">
                                        <Key frame="14" value="-31.0254" />
                                        <Key frame="21" value="-63.457" />
                                        <Key frame="33" value="-66.3574" />
                                        <Key frame="44" value="-29.8144" />
                                        <Key frame="50" value="-23.7127" />
                                        <Key frame="58" value="-54.2212" />
                                        <Key frame="64" value="-60.0141" />
                                        <Key frame="78" value="-44.7642" />
                                        <Key frame="90" value="-69.6973" />
                                        <Key frame="98" value="-69.6973" />
                                        <Key frame="127" value="-29.0918" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="LElbowYaw" mute="0" unit="0">
                                        <Key frame="14" value="-67.1484" />
                                        <Key frame="21" value="-67.2363" />
                                        <Key frame="33" value="-43.1543" />
                                        <Key frame="41" value="-42.79" />
                                        <Key frame="50" value="-61.9502" />
                                        <Key frame="64" value="-38.8325" />
                                        <Key frame="78" value="-59.7935" />
                                        <Key frame="90" value="-41.1328" />
                                        <Key frame="98" value="-41.1328" />
                                        <Key frame="127" value="-70.2246" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="LHand" mute="0" unit="1">
                                        <Key frame="14" value="0.589631" />
                                        <Key frame="21" value="0.330404" />
                                        <Key frame="33" value="0.330404" />
                                        <Key frame="49" value="0.330404" />
                                        <Key frame="65" value="0.330404" />
                                        <Key frame="82" value="0.360281" />
                                        <Key frame="98" value="0.450791" />
                                        <Key frame="127" value="0.599297" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="LShoulderPitch" mute="0" unit="0">
                                        <Key frame="14" value="89.8242" />
                                        <Key frame="21" value="53.7012" />
                                        <Key frame="49" value="-34.1409" />
                                        <Key frame="65" value="-33.6875" />
                                        <Key frame="82" value="-33.2227" />
                                        <Key frame="98" value="33.8379" />
                                        <Key frame="127" value="89.8242" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="LWristYaw" mute="0" unit="0">
                                        <Key frame="14" value="-7.99575" />
                                        <Key frame="21" value="3.78175" />
                                        <Key frame="33" value="34.1923" />
                                        <Key frame="49" value="31.9071" />
                                        <Key frame="65" value="23.0692" />
                                        <Key frame="82" value="13.9772" />
                                        <Key frame="98" value="38.0595" />
                                        <Key frame="127" value="-3.0738" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="HeadPitch" mute="0" unit="0">
                                        <Key frame="14" value="-5.80078" />
                                        <Key frame="21" value="9.14062" />
                                        <Key frame="33" value="9.14062" />
                                        <Key frame="49" value="9.14062" />
                                        <Key frame="65" value="9.14062" />
                                        <Key frame="82" value="5.53711" />
                                        <Key frame="98" value="-1.66993" />
                                        <Key frame="127" value="-11.3379" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="HeadYaw" mute="0" unit="0">
                                        <Key frame="14" value="-10.2832" />
                                        <Key frame="21" value="13.5352" />
                                        <Key frame="33" value="13.5352" />
                                        <Key frame="49" value="13.5352" />
                                        <Key frame="65" value="13.5352" />
                                        <Key frame="82" value="10.8984" />
                                        <Key frame="98" value="6.50391" />
                                        <Key frame="127" value="0.527345" />
                                    </ActuatorCurve>
                                    <ActuatorCurve name="value" actuator="LShoulderRoll" mute="0" unit="0">
                                        <Key frame="14" value="10.1074" />
                                        <Key frame="21" value="19.7754" />
                                        <Key frame="35" value="18.4201" />
                                        <Key frame="49" value="31.8783" />
                                        <Key frame="65" value="18.6306" />
                                        <Key frame="82" value="48.252" />
                                        <Key frame="98" value="21.6004" />
                                        <Key frame="127" value="8.17382" />
                                    </ActuatorCurve>
                                </ActuatorList>
                            </Timeline>
                        </Box>
                        <Link inputowner="4" indexofinput="2" outputowner="1" indexofoutput="4" />
                        <Link inputowner="2" indexofinput="2" outputowner="0" indexofoutput="2" />
                        <Link inputowner="3" indexofinput="2" outputowner="5" indexofoutput="4" />
                        <Link inputowner="4" indexofinput="2" outputowner="3" indexofoutput="4" />
                        <Link inputowner="1" indexofinput="2" outputowner="5" indexofoutput="3" />
                        <Link inputowner="5" indexofinput="2" outputowner="2" indexofoutput="3" />
                        <Link inputowner="0" indexofinput="4" outputowner="4" indexofoutput="3" />
                    </Diagram>
                </BehaviorKeyframe>
            </BehaviorLayer>
        </Timeline>
    </Box>
</ChoregrapheProject>
